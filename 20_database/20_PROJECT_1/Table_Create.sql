--북테이블-- 
CREATE TABLE BOOK (
    ID NUMBER PRIMARY KEY,
    NAME VARCHAR2(100) NOT NULL,
    WRITER VARCHAR2(30) NOT NULL,
    PUBLISHER VARCHAR2(50) NOT NULL,
    CLASSFICATION VARCHAR2(30) NOT NULL,
    PRICE VARCHAR2(30) NOT NULL,
    RELEASDATE VARCHAR2(50) NOT NULL
);

COMMENT ON COLUMN BOOK.ID IS '아이디';
COMMENT ON COLUMN BOOK.NAME IS '책이름';
COMMENT ON COLUMN BOOK.WRITER IS '작가';
COMMENT ON COLUMN BOOK.PUBLISHER IS '출판사';
COMMENT ON COLUMN BOOK.CLASSFICATION IS '분야';
COMMENT ON COLUMN BOOK.PRICE IS '가격';
COMMENT ON COLUMN BOOK.RELEASDATE IS '등록일';
COMMIT;


INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (1, '달러구트 꿈 백화점',  '이미예', '팩토리나인', '문학', '13800', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (2, '지구 끝의 온실', '김초엽', '자이언트북스', '문학', '15000', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (3, '코스모스',  '칼 세이건', '사이언스북스', '과학', '18500', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (4, '지구인만큼 지구를 사랑할 순 없어 ', '정세랑', '위즈덤하우스', '여행', '16800', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (5, '양순이네 떡집', '김리리', '비룡소', '유아', '11000', '2021/08/30');
  


INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (6, '이토록 매혹적인 아랍이라니', '손원호', '부키', '여행', '15000', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (7, '지구 끝의 온실', '김초엽', '자이언트북스', '여행', '18000', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (8, '여행의 이유', '김영하', '문학동네', '여행', '13500', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (9, '밤을 걷는 밤', '유희열', '위즈덤하우스', '여행', '15000', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (10, '인간 실격', '다자이 오사무', '민음사', '고전', '8000', '2021/08/30');
          
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (11, '오만과 편견', '제인 오스틴', '문학동네', '고전', '16000', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (12, '1984', '조지 오웰', '민음사', '고전', '9500', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (13, '군주론', '니콜라 마키아밸리', '현대지성', '고전', '7700', '2021/08/30');
SELECT * FROM BOOK;INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (14, '이기적 유전자', '리처드 도킨스', '을유문화사', '과학', '20000', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (15, '침묵의 봄', '레이철 카슨', '에코리브르', '과학', '18000', '2021/08/30');
          
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (16, '벌거벗은 미술관', '양정무', '창비', '예술', '18000', '2021/08/30');
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (17, '방구석 미술관', '조원재', '블랙피쉬', '예술', '16800', '2021/08/30');   
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (18, '방구석 미술관2', '조원재', '블랙피쉬', '예술', '18500', '2021/08/30');            
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (19, '친일파', '박시백', '민족문제연구소', '비아북', '16000', '2021/08/30');          
INSERT INTO BOOK (ID, NAME, WRITER, PUBLISHER, CLASSFICATION, PRICE, RELEASDATE)
          VALUES (20, '사피엔스', '유발 하라리', '감영사', '문학', '22000', '2021/08/30');        

COMMIT;


--지점 테이블--
CREATE TABLE STORE(
    STORENAME VARCHAR2(30) PRIMARY KEY,
    STORECALL VARCHAR2(100),
    STOREADDRESS VARCHAR2(300) ,
    STOREMAIL VARCHAR2(300),
    STORETIME VARCHAR2 (200) 
);

COMMIT;


COMMENT ON COLUMN STORE.STORENAME IS '지점이름';
COMMENT ON COLUMN STORE.STORECALL IS '지점전화번호';
COMMENT ON COLUMN STORE.STOREADDRESS IS '지점주소';
COMMENT ON COLUMN STORE.STOREMAIL IS '지점메일';
COMMENT ON COLUMN STORE.STORETIME IS '영업시간';
COMMIT;


INSERT INTO STORE
  VALUES ('신촌점', '02-111-1111', '서울시 서대문구 신촌동', 'sc@store.com','오전10시_오후8시') 
 ; 


INSERT INTO STORE
 VALUES('강남점','02-222-2222',  '서울시 강남구 서초동','kn@store.com', '오전10시_오후8시')
 ;
 
INSERT INTO STORE
 VALUES('잠실점','02-333-3333', '서울시 송파구 잠실동','js@store.com', '오전10시_오후8시')
 ;
COMMIT;


--재고 테이블 -- 
CREATE TABLE STORAGE (
    ID NUMBER PRIMARY KEY,
    STORENAME VARCHAR2(30) REFERENCES STORE(STORENAME) NOT NULL,
    BOOKID NUMBER REFERENCES BOOK(ID) NOT NULL,
    BOOKCNT NUMBER
);

COMMENT ON COLUMN STORAGE.ID IS '창고번호';
COMMENT ON COLUMN BOOK.NAME IS '지점이름';
COMMENT ON COLUMN BOOK.WRITER IS '책번호';
COMMENT ON COLUMN BOOK.PUBLISHER IS '수량';
COMMIT;




INSERT INTO STORAGE VALUES (1, '신촌점', 1, 5);
INSERT INTO STORAGE VALUES (2, '신촌점', 2, 1);
INSERT INTO STORAGE VALUES (3, '신촌점', 3, 1);
INSERT INTO STORAGE VALUES (4, '강남점', 1, 3);
INSERT INTO STORAGE VALUES (5, '잠실점', 5, 4);
 
INSERT INTO STORAGE VALUES (6, '강남점', 1, 3);
INSERT INTO STORAGE VALUES (7, '강남점', 11, 0);
 
 
 
 SELECT COUNT(*)
    FROM STORAGE G, STORE S
    WHERE G.STORENAME = S.STORENAME  
    AND BOOKID = 1    
;

--지점별 총 재고 확인
SELECT S.STORENAME, SUM(BOOKCNT)
 FROM BOOK B, STORAGE S
 WHERE B.ID = S.BOOKID
 GROUP BY S.STORENAME
;

SELECT * FROM STORE;

--지점 별 책 조회 
SELECT B.NAME, S.STORENAME, S.BOOKCNT
 FROM BOOK B, STORAGE S
 WHERE B.ID = S.BOOKID
;


SELECT * FROM STORE;

SELECT * FROM STORAGE;

SELECT * FROM BOOK;


UPDATE STORE SET STORECALL = '02-333-3333' WHERE STORENAME = '잠실점';

UPDATE STORE SET STOREADDRESS = '서울시 강남구 서초동' WHERE STORENAME = '강남점';

UPDATE STORE SET STORETIME = '오전10시_오후8시' WHERE STORENAME = '강남점';

INSERT INTO STORE(STORENAME, STORECALL, STOREADDRESS, STOREMAIL, STORETIME)
VALUES ('서촌점', '02-444-4444','서울시종로구누하동', 'ch@store.com', '오전10시_오후8시') ;







